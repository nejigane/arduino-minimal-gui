#include "Font.h"

static const uint8_t data[1151] PROGMEM = {
  0,34,248,248,13,13,21,56,56,0,56,56,0,0,0,0,
  0,21,96,248,96,248,96,3,15,3,15,3,6,96,144,248,
  248,144,32,2,4,15,15,4,3,6,56,40,184,192,112,24,
  12,7,1,14,10,14,6,112,248,136,248,112,0,7,15,8,
  15,6,11,34,120,120,0,0,20,192,240,56,8,1,7,14,
  8,20,8,56,240,192,8,14,7,1,6,128,160,192,192,160,
  128,1,5,3,3,5,1,6,128,128,224,224,128,128,1,1,
  7,7,1,1,20,0,0,0,0,16,30,14,6,6,0,0,
  0,0,0,0,1,1,1,1,1,1,20,0,0,0,0,8,
  28,28,8,6,0,0,128,224,120,24,12,15,3,0,0,0,
  6,224,240,8,8,240,224,3,7,8,8,7,3,6,32,16,
  248,248,0,0,8,8,15,15,8,8,6,48,56,136,136,248,
  112,14,15,9,8,8,8,6,8,136,200,232,184,24,4,12,
  8,8,15,7,6,128,192,96,48,248,248,3,3,2,2,15,
  15,6,248,248,72,72,200,136,4,12,8,8,15,7,6,240,
  248,136,136,152,16,7,15,8,8,15,7,6,8,8,8,200,
  248,56,0,12,15,3,0,0,6,112,248,136,136,248,112,7,
  15,8,8,15,7,6,112,248,136,136,248,240,4,12,8,8,
  15,7,20,64,224,224,64,8,28,28,8,20,64,224,224,64,
  16,30,14,6,6,128,192,96,48,24,8,0,1,3,6,12,
  8,6,64,64,64,64,64,64,2,2,2,2,2,2,6,8,
  24,48,96,192,128,8,12,6,3,1,0,6,48,56,136,136,
  248,112,0,0,13,13,0,0,6,240,8,200,72,248,240,7,
  8,9,9,13,5,6,240,248,136,136,248,240,15,15,0,0,
  15,15,6,248,248,136,136,248,112,15,15,8,8,15,7,6,
  240,248,8,8,24,16,7,15,8,8,12,4,6,248,248,8,
  8,248,240,15,15,8,8,15,7,6,248,248,136,136,136,8,
  15,15,8,8,8,8,6,248,248,136,136,136,8,15,15,0,
  0,0,0,6,240,248,8,136,152,144,7,15,8,8,15,15,
  6,248,248,128,128,248,248,15,15,0,0,15,15,6,8,8,
  248,248,8,8,8,8,15,15,8,8,6,0,0,0,0,248,
  248,4,12,8,8,15,7,6,248,248,192,96,48,24,15,15,
  1,3,6,12,6,248,248,0,0,0,0,15,15,8,8,8,
  8,6,248,240,96,96,240,248,15,15,0,0,15,15,6,248,
  248,224,128,248,248,15,15,0,3,15,15,6,240,248,8,8,
  248,240,7,15,8,8,15,7,6,248,248,136,136,248,112,15,
  15,0,0,0,0,6,240,248,8,8,248,240,7,15,10,12,31,
  23,6,248,248,136,136,248,112,15,15,1,3,6,12,6,112,
  248,136,136,152,16,4,12,8,8,15,7,6,8,8,248,248,
  8,8,0,0,15,15,0,0,6,248,248,0,0,248,248,7,
  15,8,8,15,7,6,56,248,0,0,248,56,0,1,15,15,
  1,0,6,248,248,0,0,248,248,15,7,3,3,7,15,6,
  24,112,192,192,112,24,12,7,1,1,7,12,6,24,120,224,
  224,120,24,0,0,15,15,0,0,6,8,8,136,200,120,56,
  14,15,9,8,8,8,20,248,248,8,8,15,15,8,8,6,
  24,120,224,128,0,0,0,0,0,3,15,12,20,8,8,248,
  248,8,8,15,15,6,96,48,24,24,48,96,0,0,0,0,
  0,0,6,0,0,0,0,0,0,24,24,24,24,24,24,20,
  4,12,24,16,0,0,0,0,6,0,64,64,64,192,128,6,
  15,9,9,15,15,6,248,248,64,64,192,128,15,15,8,8,
  15,7,6,128,192,64,64,192,128,7,15,8,8,12,4,6,
  128,192,64,64,248,248,7,15,8,8,15,15,6,128,192,64,
  64,192,128,7,15,9,9,13,5,6,128,240,248,136,24,16,
  0,15,15,0,0,0,6,128,192,64,64,128,192,21,63,42,
  42,59,17,6,248,248,64,64,192,128,15,15,0,0,15,15,
  6,0,64,216,216,0,0,8,8,15,15,8,8,6,0,0,
  0,0,216,216,16,48,32,32,63,31,6,248,248,0,128,192,
  64,15,15,3,7,12,8,6,0,8,248,248,0,0,8,8,
  15,15,8,8,6,192,192,128,192,192,128,15,15,1,1,15,
  15,6,192,192,64,64,192,128,15,15,0,0,15,15,6,128,
  192,64,64,192,128,7,15,8,8,15,7,6,192,192,64,64,
  192,128,63,63,4,4,7,3,6,128,192,64,64,192,192,3,
  7,4,4,63,63,6,192,192,64,64,192,128,15,15,0,0,
  0,0,6,128,192,64,64,192,128,4,13,9,10,14,4,6,
  64,240,240,64,64,0,0,7,15,8,12,4,6,192,192,0,
  0,192,192,7,15,8,8,15,15,6,192,192,0,0,192,192,
  1,7,14,14,7,1,6,192,192,0,0,192,192,7,15,6,
  6,15,7,6,192,192,0,0,192,192,12,15,3,3,15,12,
  6,192,192,0,0,192,192,19,55,36,36,63,31,6,64,64,
  64,64,192,192,12,14,10,9,9,8,20,176,248,72,8,6,
  15,9,8,34,248,248,15,15,20,8,72,248,176,8,9,15,
  6,6,48,24,24,48,48,24,0,0,0,0,0,0
};

namespace minimal {

void Font::getData(const char* string, uint8_t* buffer, uint8_t bufferLength, bool isUpper) {  
  while(*string != '\0' && bufferLength > 0) {
    uint8_t code = *string;
    if (code < 32 || code > 126) code = 32;

    const uint8_t* d = data;
    uint8_t c = 32;
    while (c <= code) {
      uint8_t info = pgm_read_byte(d);
      uint8_t offset = info >> 4;
      uint8_t width = info & 15;

      if (c == code) {
        buffer += offset;
        bufferLength = bufferLength > offset ? bufferLength - offset : 0;
        d += isUpper ? 1 : 1 + width;
        for (uint8_t i = 0; i < width && bufferLength > 0; ++i, ++d, ++buffer, --bufferLength)
          *buffer |= pgm_read_byte(d);
        buffer += 7 - (offset + width);
        break;
      }

      d += 1 + width * 2;
      ++c;
    }

    ++string;
  }
}

}